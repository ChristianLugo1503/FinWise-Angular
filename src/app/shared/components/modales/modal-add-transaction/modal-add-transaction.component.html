<div class="fixed inset-0 z-50 flex items-center justify-center backdrop-blur-sm bg-black/10 animate-fade-in-opacity">

  <div class="border-2 border-white fixed bg-[#0A1232] top-20 rounded-lg max-w-sm w-96 min-w-80  animate-slide-in-top h-[33rem] overflow-auto" (click)="$event.stopPropagation()">
    
    <!-- TITULO Y SALIR -->
    <div class="sticky top-0 bg-[#0A1232] z-10 flex flex-row items-center justify-between py-2 px-4">
      <div class="ml-1 h-full">
        <h2 class="text-2xl font-bold text-center text-white">Nuevo {{ data.title }}</h2>
      </div>
      <button class="transition transform ease-in-out duration-500 text-white text-3xl hover:text-red-600 hover:scale-110 font-bold" (click)="closeModal()">×</button>
    </div>

    <!-- FORMULARIO -->
    <form [formGroup]="form()" action="#" class="mt-2 overflow-auto pt-2  p-4">
            
      <!-- INPUT MOUNT -->
      <div class="input-group relative mb-5">

        <div class="w-full">
          <span class="absolute top-3 left-2 text-white">$</span>
            <input 
              class="input px-6 py-1"
              [ngClass]="{'error': checkMount() !== ''}"
              formControlName="amount" 
              type="number"
              step="0.01" min="0"
            />
            <label class="user-label font-semibold text-lg" >Ingrese el monto</label>
        </div>

        <!-- MENSAJE ERROR -->
        <div *ngIf="checkMount() !== ''" class="absolute top-3 end-0 text-sm text-red-600" role="alert">
            <svg class="flex-shrink-0 inline w-4 h-4 me-1 cursor-pointer" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20">
                <title>{{checkMount()}}</title>
                <path d="M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z"/>
            </svg>
        </div>

      </div>

      <!-- INPUT CATEGORIA -->
      <div [ngClass]="{'errorCategory': this.form().get('categoryID')?.invalid &&  this.form().get('categoryID')?.touched}" class="group h-40 relative mb-5 border-2 border-white rounded-lg px-2 pb-2 flex">
        <label class="user-label font-semibold text-lg group-[.errorCategory]:text-[#C92628]">Seleccione una categoría</label>

        <div class="flex w-full flex-wrap overflow-auto justify-start mt-[11px]">
          <div class="uno mt-3 flex w-full w-1/5 px-2" *ngFor="let category of filteredCategories">
            <label class="cursor-pointer flex flex-col items-center break-all w-12 text-sm hover:scale-105 transition ease-in-out duration-500">
              <input
                type="radio"
                name="categoryID"
                [value]="category.id"
                formControlName="categoryID"
                class="radio-input"
              />
              <img
                [src]="category.image"
                [alt]="category.id"
                [class.selected]="form().get('categoryID')?.value === category.id"
                class="category-image w-12 h-12 rounded-full mt-2 border-[1px] border-[transparent]"
              />
              {{ category.name }}
            </label>
          </div>
        </div>
      </div>


      <!-- INPUT DATE -->
      <div class="input-group relative mb-5">
        <div class="w-full">
            <input [ngClass]="{'error': hasRequiredError('date')}"  formControlName="date" type="date" name="text" autocomplete="off" class="input px-6 py-1" [value]="currentDate" >
            <label class="user-label font-semibold text-lg" >Fecha</label>
        </div>
        <div *ngIf="hasRequiredError('date')" class="absolute top-3 end-0 text-sm text-red-600" role="alert">
            <svg class="flex-shrink-0 inline w-4 h-4 me-2 cursor-pointer" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20">
                <title>Campo obligatorio</title>
                <path d="M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z"/>
            </svg>
        </div>
      </div>

      <!-- INPUT COMENTARIO -->
      <div class="input-group relative mb-5">
        <div class="w-full">
            <input [ngClass]="{'error': hasRequiredError('description')}"  formControlName="description" type="text" name="text" autocomplete="off" class="input " >
            <label class="user-label font-semibold text-lg" >Comentario</label>
        </div>
        <div *ngIf="hasRequiredError('description')" class="absolute top-3 end-0 text-sm text-red-600" role="alert">
            <svg class="flex-shrink-0 inline w-4 h-4 me-3 cursor-pointer" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20">
                <title>Campo obligatorio</title>
                <path d="M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z"/>
            </svg>
        </div>
      </div>

      <div class="mt-7">
          <button 
            (click)="sendForm()" 
            [disabled]="form().invalid || (form().get('amount')?.value === 0)" 
            [title]="form().get('categoryID')?.invalid ? 'No seleccionó ninguna categoría' : ''"
            class="bg-white w-full py-3 rounded text-[#0A1232] shadow-xl hover:shadow-inner focus:outline-none transition duration-300 ease-in-out font-semibold transform hover:-translate-x enabled:hover:scale-105 disabled:opacity-75 disabled:cursor-not-allowed" >
              Aceptar
          </button>
      </div>

      <!-- <p>Tipo de transaccion: {{data.title}}</p>
      <p>Monto: {{this.form().get('amount')?.value}}</p>
      <p>Categoria: {{this.form().get('categoryID')?.value}}</p>
      <p>Fecha: {{this.form().get('date')?.value}}</p>
      <p>Comentario: {{this.form().get('description')?.value}}</p>
      <p>formulario invalido: {{form().invalid}}</p>
      <p>El monto es valido ?: {{this.form().get('amount')?.valid}}</p>
      <p>La categoria es valida ?: {{this.form().get('categoryID')?.valid}}</p>
      <p>La fecha es valida ?: {{this.form().get('date')?.valid}}</p>
      <p>El comentario es valido ?: {{this.form().get('description')?.valid}}</p> 
       -->

    </form>
    

  </div>
  
</div>
  
    